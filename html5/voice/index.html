<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Voice</title>
    <link rel="stylesheet" href="./style.css">
    <link href='https://fonts.googleapis.com/css?family=Pacifico' rel='stylesheet' type='text/css'>
</head>

<body>
    <div class="voice_container">
        <h1>The Voiceinatior 500</h1>
        <select name="voice" id="voices">
            <option value="">Select A Voice</option>
        </select>
        <label for="rate">Rate:</label>
        <input type="range" min="0" max="3" step="0.1" value="1" name="rate">
        <label for="pitch">Pitch:</label>
        <input type="range" min="0" max="2" step="0.1" value="1" name="pitch">
        <textarea name="text" id="">hello! I love javascript!</textarea>
        <!-- button[id]*2 -->
        <button id="stop">Stop!</button>
        <button id="speak">Speak</button>
    </div>
    <script>
        // let voices = [];
        const msg = new SpeechSynthesisUtterance();
        msg.text = document.querySelector('[name="text"]').value;
        const speakButton = document.querySelector('#speak');
        const options = document.querySelectorAll('[type="range"],[name="text"]');
        // const voicesDropdown = document.querySelector('[name="voice"]');
        function doSpeak() {
            speechSynthesis.speak(msg);
        }

        // function populateVoices() {
        //     voices = this.getVoices();
        //     // console.log(voices);
        //     let html = '';
        //     // for(var i = 0; i < voices.length; i++) {
        //     //     html += `<option value="${voices[i].name}">${voices[i].name}</option>`;
        //     // }
        //     let lanlist = voices.map((lan) => {
        //         return `<option value="${lan.name}">${lan.name} (${lan.lang})</option>`
        //     });
        //     voicesDropdown.innerHTML = lanlist.join('');
        //     // voicesDropdown.innerHTML = html;             /*innerHTML在JS是双向功能：获取对象的内容 或 向对象插入内容*/
        //     console.log(html);
        // }

        function setOption() {
            console.log(this, this.value);
            // msg.text
            // msg.pitch
            // msg.rate
            msg[this.name] = this.value;
            doSpeak();
        }

        // function setVoice() {
        //     msg.voice = voices.find(voice => voice.name === this.value);
        //     doSpeak();
        // }

        options.forEach(function (option) {
            option.addEventListener('change', setOption);                 /*callback*/
        });

        speakButton.addEventListener('click', doSpeak);
        // speechSynthesis.addEventListener('voiceschanged', populateVoices);
        // voicesDropdown.addEventListener('change', setVoice);
    </script>
</body>

</html>